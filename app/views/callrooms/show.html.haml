%head
  %script{src: "//cdn.webrtc.ecl.ntt.com/skyway-latest.js"}

%header
  = render "tweets/header"
.author
  .teacher 先生
  = link_to "#", class: "link-image" do
    - if @callroom.user.image.present?
      %p
        = image_tag @callroom.user.image.url, class: 'author__image'
    - else
      .author__no-image
        No-
        %br
        image
  = link_to "#", class: "author__name" do
    = @callroom.user.name
  -if @student.present?
    .student 生徒
    = link_to "#", class: "link-image" do
      - if @student.image.present?
        %p
          = image_tag @student.image.url, class: 'author__image'
      - else
        .author__no-image
          No-
          %br
          image
    = link_to "#", class: "author__name" do
      = @student.name
  -else
    .student 生徒はまだいません
  -if user_signed_in? && current_user.id == @callroom.user_id
    .teachManage
      = link_to "編集", edit_callroom_path(@callroom.id), class: "teachManage__edit"
      = link_to "削除", callroom_path(@callroom.id), method: :delete, class: "teachManage__destroy"
      - if @callroom.status == 0
        = link_to "公開", update_attribute_callrooms_path, method: :get, class: "teachManage__destroy"
      - elsif @callroom.status == 1
        = link_to "非公開",update_attribute_callrooms_path, method: :get, class: "teachManage__destroy"
      - else @callroom.status == 3
        = link_to "通信を切りますか",update_attribute_callrooms_path, method: :get, class: "teachManage__destroy"

%h1.show-title
  教えて電話解決！
-# - binding.pry
- if @callroom.user_id == current_user.id && @callroom.status == 3
  %p.infomation #{@student.name}さんと通信中
- elsif  @callroom.status == 3 && @callroom.student_id == current_user.id
  %p.infomation #{@callroom.user.name}さんと通信中
.container
  .p2p-media
    .local-stream
      %video#js-local-stream
    .remote-stream
      %video#js-remote-stream


.tell
  %p あなたの電話番号:
  %span#js-local-id
  %p.tell__note
    あなたの電話番号12桁の番号をメッセージを活用して教えて下さい
  %input#js-remote-id{placeholder: "相手の電話番号を入力", type: "text"}/
  %button#js-call-trigger 電話をする
  %button#js-close-trigger 通信終了
%p#js-meta.meta
-# .form
-#   = form_for [@teach, @message] do |f|
-#     = f.text_field :comment, class: 'form__message', placeholder: 'type a message'
-#     .form__mask
-#       = f.label :image, class: 'form__mask__image' do
-#         = icon('fas', 'image', class: 'icon')
-#         = f.file_field :image, class: 'hidden'
-#     = f.submit 'Send', class: 'form__submit'

-# .message-list
-#   = render partial: 'message', collection: @messages, as: :messages

.teach
  .teach__title
    = @callroom.title
  .teach__tags
    .teach__tags__tag
  .teach__body
    = @callroom.body
  - if @callroom.image.present?
    %p
      = image_tag @callroom.image.url, class: 'teach__image'

%input{name: "callroom_id",type: "hidden",  value: @callroom.id, class: 'callroom_id'}